<!DOCTYPE html>
<html>
    <head>
        <title>ê³ ìš” ì†ì˜ ì™¸ì¹¨</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    </head>
    <body>
        <h2>ğŸ”‡ ê³ ìš” ì†ì˜ ì™¸ì¹¨</h2>
        í•  ë§ì´ í„± ëê¹Œì§€ ì°¨ì˜¤ë¥´ì§€ë§Œ ì… ë°–ìœ¼ë¡œ êº¼ë‚´ì§€ ëª»í•  ë•Œ, í„¸ì–´ ë†“ì„ ê³³ì´ ì—†ì„ ë•Œ, ë‹µë‹µí•¨ì— í¬ê²Œ ì†Œë¦¬ ì§€ë¥´ê³  ì‹¶ì„ ë•Œ, ê³ ìš” ì†ì—ì„œ ì™¸ì¹˜ì„¸ìš”.
        <form action="" onsubmit="sendMessage(event)" style="padding: 10px 0px">
            <input type="text" id="messageText" autocomplete="off"/>
            <button>ì™¸ì¹˜ê¸°</button>
        </form>
        <div id='messages'>
        </div>
        <script>
            const ws = new WebSocket("ws://localhost:8000/api/v1/shout");
            ws.onmessage = function(event) {
                const messages = document.getElementById('messages')
                const message = document.createElement('div')
                const data = JSON.parse(event.data)
                const content = data.content
                const timestamp= moment(Date(data.timestamp)).format("hh:mm:ss a")
                message.appendChild(document.createTextNode(`"${content}" at ${timestamp}`))
                message.appendChild(document.createElement('hr'))
                messages.appendChild(message)
            };
            function sendMessage(event) {
                const input = document.getElementById("messageText")
                const timestamp = new Date().getTime()
                const data = {"content": input.value, "timestamp": timestamp}
                ws.send(JSON.stringify(data))
                input.value = ''
                event.preventDefault()
            }
        </script>
    </body>
</html>
